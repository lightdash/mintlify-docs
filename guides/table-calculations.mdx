---
title: "Table calculations"
description: "Table calculations make it easy to create metrics on the fly (for example, aggregating the data in your table over some window, or getting a running total of a column)."
---

You add table calculations in the Explore view and they appear as green columns in your results table (remember, [dimensions](/references/dimensions) are blue, and [metrics](/references/metrics) are orange).

<Frame>
  <img src="/images/guides/table-calculations/table-calculations-add-a932fb32af1dc604d4ef709886f9a833.jpg"/>
</Frame>

Table calculations are built using raw SQL. That means you can use table calculations to build mathematical, True/False, text, and date-based calculations (basically, anything you can do in SQL, you can do in table calculations).

## When to use table calculations

The Lightdash semantic layer allows you to define metrics and dimensions that can be reused across your organization. This creates consistency and saves time by establishing standard definitions everyone can rely on. Sometimes the predefined metrics and dimensions aren't quite enough, and you might need to perform additional calculations for specific visualizations, create specialized metrics for particular analyses, or build custom logic to better communicate your insights.

### How Table Calculations Help

Table calculations work as an additional computational layer that builds on top of:

- Semantic layer metrics and dimensions (your standard definitions)
- Custom metrics and dimensions (created at the BI layer)
- Other table calculations (you can even stack them)

<Warning>
Table calculations are useful for specialized, temporary needs, but if you find yourself repeatedly reusing a table calculation, it's a sign to add it to dbt so it's tracked in the semantic layer. This keeps your organization's metrics centralized and consistently defined. You can read more about [adding metrics to your dbt project here](/references/metrics).
</Warning>

## Creating table calculations

Before you create a table calculation, you need to add some dimensions and/or metrics to your results table.

Table calculations work with whatever data you've already pulled into your results table - they can reference the dimensions and metrics you've selected, as well as other table calculations you've built from those same underlying fields. Think of it like building with blocks: you start with your base dimensions and metrics, then you can stack table calculations on top of those, and even build new calculations that reference the ones you've already created.

### Using quick calculations

Quick calculations are shortcuts to the most common table calculations, these are only available to metrics in the contextual menu in the results table.

<Frame>
![](/images/guides/table-calculations/quick-table-calculation-b1e76d3e54d84ca3c5066ffdf989514b.png)
</Frame>

To learn more about what these calculations are doing, check out the docs [here](/guides/table-calculations/sql-templates). Once the table calculation is generated you can edit it to modify the SQL query or update the format.

### Using custom table calculations

Once you've got some data in your results table, you can create a table calculation by clicking on the `+ Table calculation` in the `Results` tab of the Explore view:

<Frame>
  ![](/images/guides/table-calculations/create-new-table-calc-772add6d063a5122c0a25accf798fbb3.jpg)
</Frame>

##### Write the SQL for your table calculation in the pop-up box

Your table calculation is defined using raw SQL that you write up in this pop up box. If you're not sure what to write here, you can [check out some of our table calculation SQL templates](#table-calculation-functions-and-sql-templates).

To reference the metrics and dimensions in your results table, you can either use the autocomplete, or you can manually write the full field name using the format `${table_name.field_name}`.

<Frame>
 ![](/images/guides/table-calculations/add-table-calc-sql-20de5398dc117ef3d4087cf3b6d9939b.jpg)
</Frame>


### Using table calculation functions

In addition to writing raw SQL, you can use built-in functions that simplify common table calculation patterns:

- **[Row functions](/references/table-calculation-functions/row-functions)** — Access values from other rows (e.g., previous row, specific row number, lookups)
- **[Pivot functions](/references/table-calculation-functions/pivot-functions)** — Access values across pivot columns

These functions compile to SQL window functions automatically, so you don't need to write `LAG`, `LEAD`, or `ROW_NUMBER` by hand.

##### Update the format of your table calculation (if needed)

If needed, you can update the format of your table calculation to things like percent formatting using the `format` tab.

<Frame>
  ![](/images/guides/table-calculations/format-table-calc-c0e3828b6681db084b4ddd6799ff2c96.jpg)
</Frame>

| Format types | Description                                     | Raw value | How it might look like in Lightdash |
| :------------ | :----------------------------------------------- | :--------- | :----------------------------------- |
| Default      | Default format for the table calculation result | 0.75      | 0.75                                |
| Percent      | Converts numbers into a percentage              | 0.75      | 75%                                 |
| Currency     | Adds currency symbol and default locale format  | 1234.1234 | $ 1234.12                           |
| Number       | Formats number with prefix and suffix           | 123.1234  | Speed: 123.12 km/h                  |

##### To delete or edit your table calculation, just click on the gear icon by the field name

If you need to edit or delete a table calculation, you can just click on the toggle beside the field and do what you need to do!

<Frame>
  ![](/images/guides/table-calculations/edit-delete-table-calc-520776c8631697527bf3760000dce88e.jpg)
</Frame>


## Table calculation execution and limitations

The processing order:

1. **Raw data filtering happens first** - Dimension and metric filters are applied to your base data.

2. **All table calculations run** - Using this filtered dataset, all calculations are performed.

3. **Table calculation filters apply last** - Only then are rows hidden based on calculated values.

### Key limitations
Since all calculations are performed before filtering, table calculation filters only hide rows without affecting the underlying calculations. 

For example: You use table calculations to calculate the `percentage_of_shipping_method_amount`, then filter to hide rows below 30%. The filtered rows (shown in purple) will disappear but the `percentage_total` calculation still shows 100% even though the visible percentages in the `percentage_of_shipping_method_amount` column no longer add up to 100%.

<Frame>
![](/images/guides/table-calculations/table_calculation_filter_example.jpg)
</Frame>

## Table calculation functions and SQL templates

If you prefer not to write raw SQL, check out the built-in [row functions](/references/table-calculation-functions/row-functions) and [pivot functions](/references/table-calculation-functions/pivot-functions) — they handle common patterns like accessing previous rows, row numbering, and working across pivot columns.

For more advanced or custom SQL, we also have copy-paste SQL templates to help you get started with common table calculations. You can check out our table calculation SQL templates [here](/guides/table-calculations/sql-templates).
